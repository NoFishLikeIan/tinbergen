\documentclass[american]{scrartcl}
    \usepackage{babel}
    \usepackage[utf8]{inputenc} 
    \usepackage{csquotes}
    \usepackage{amsmath}
    \usepackage{amssymb}
    \usepackage{graphicx} 
    \usepackage{subfigure}
    \usepackage{mathtools}

    
    \setlength{\parindent}{0em}
    \setlength{\parskip}{0.5em}

    % Bibliography and citations
    \usepackage[bibencoding=utf8, style=apa]{biblatex}
    \bibliography{ref}

    
    \title{A model of Cournot Competition with group selection}


    \author{Andrea Titton}
    

% Commands
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\Two}{\mathbf{2}}

\begin{document}

% Title

\maketitle

\section{Introduction}

In 1838, Antoine Augustin Cournot introduced his famous model of competition over quantities. Since then, the model served as a theoretical benchmark for pure oligopolistic models in economic theory. In Cournot oligopolies, a discrete number of firms compete by setting quantities of a perfectly substitutable good. In equilibrium, due to symmetry, all firms produce the same quantity and any deviations my producers reduces their own profit.

In proposing the model, Cournot does not address the formation mechanisms of the firms' strategies. Modern economics relies on rational expectations to justify the symmetric equilibrium solution. More contemporary approaches have derived the model dynamics under limited knowledge (\cite{Bischi2015}) or naive expectations (\cite{Cnovas2008}). Furthermore the model is known to lead to unstable equilibria as the number of firms increases (this is known as the Cournot–Theocharis problem).

In this short paper I propose to study the dynamics of equilibrium formation via an evolutionary lens. The aim is to focus on the tacit collusion effect that leads to oligopolistic equilibria in concentrated markets and the competition effect that arises in fragmented markets. Based on the framework by \citeauthor{Akdeniz2020} (\citeyear{Akdeniz2020}), I develop a model with local markets competing à la Cournot % TODO: Finish introduction

\iffalse
    \newpage
    \section{Literature review}
\fi

\newpage
\section{Theoretical formulation}

\subsection{Local markets}

Local markets are composed by $N$ firms, indexed by $i$, that can pick a production quantity from a discrete set $q^{(i)} \in \Sigma$. Firm's face linear demand,

\begin{equation}
    p(q^{(1)}, \ldots, q^{(N)}) = p(Q)= a - b \cdot \sum^{N}_{i=1} q^{(i)}
\end{equation}

where $a$ and $b$ are picked for normalization purposes. Furthermore firm face no fixed nor marginal costs. All of these assumptions can be easily relaxed to allow for non-linear demand, entry costs, and marginal costs. The symmetric Nash equilibrium of the game is,

\begin{equation}
    \bar{q}= \frac{a}{b \cdot (N+1)}
\end{equation}



The model evolves over discrete time $t \in \set{0, 1, \ldots T}$ and firms are assumed to enter the market playing a random draw from the strategy set,  $q^{(i)}_0 \sim U(\Sigma)$. In every period each company realizes a payoff, $\pi^{(i)}_t = p(Q_t) \cdot q^{(i)}_t$. I assume that each period a firm is picked at random, with probability proportional to its payoff, to reproduce in a birth-death process. In particular, the probability of a strategy, say $\sigma \in \Sigma$ played by $n$ firms, being picked for reproduction is,

\begin{equation}
    \frac{n \cdot \exp(P(Q_t) \cdot \sigma)}{\sum_{i} \exp(P(Q_t) \cdot q^{(i)})}.
\end{equation}



This modelling choice is justified in the context of oligopolies were firms copy other firms' production quantities in case the competitor is experiencing better profits. This arises for example in the airline industry, were capacity (number of flights) has to be planned \textit{ex-ante} to comply with regulations. Furthermore, these are markets with high barriers to entry (fixed $N$), long-term investment commitments (randomness in the birth-death process), and common tacit collusion.

\subsection{Global market}

In the model, there are $M$ local markets and each local market is linked to two other neighboring markets, thus forming a cycle. Each turn, with probability $\rho$, a market is picked at random, with probability $1 / N$, and is merged with its best performing neighbor. This choice arises assuming that highly profitable local markets will be invaded by neighboring firms. In this way tacit collusion, on the one hand, pushes up payoffs and, on the other hand, it increases the likelihood of a neighboring entry.



\begin{center}
    \begin{figure}[h!]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/step_group.png}
        \caption{Diagram illustrating the takeover in the global market}
        \label{fig:diagram}
    \end{figure}
\end{center}


\newpage
\section{Simulation}

In the simulations I pick $\Sigma = \set{1, 2, \ldots, 10}$, $a = (N + 1) \cdot 5$, and $b = 1$, such that,

\begin{equation}
    \bar{q} = 5
\end{equation}

\subsection{Local market}

First we can focus on a simulation of a local market, without group effects. In particular here we look at the evolution of quantities and prices when $N = 5$ and $N = 20$.

Figure \ref{fig:small_local} shows one of the runs, for $T = 200$, in the case of a concentrated market. As expected, tacit collusion occurs vary quickly as all firms synchronize to a low quantity.

\begin{center}
    \begin{figure}[h!]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/q_group_heat_5.png}
        \caption{Quantity evolution in a concentrated market}
        \label{fig:small_local}
    \end{figure}
\end{center}

Figure \ref{fig:price_small_local} displays the price evolution $p(Q_t)$ of a number ($150$) of simulations with concentrated markets. All simulations display tacit collusion but this highlights the path dependency of the equilibrium price. This is expected as, for example, if enough firms start off producing a quantity above $\bar{q}$ which yields $p(Q_0) \approx 0$, firm's who produce the highest quantity have higher fitness and hence the price will be driven further down.

\begin{center}
    \begin{figure}[h!]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/p_group_5.png}
        \caption{Price evolution in a concentrated market}
        \label{fig:price_small_local}
    \end{figure}
\end{center}

If we turn our attention to a highly competitive markets and we repeat the exercise, the dynamics change drastically. In particular, Figure \ref{fig:large_local} shows the evolution of strategies of a single run. Here firms fail to collude and prices tend towards the equilibrium (in this case, $\bar{q} = 5$).

\begin{center}
    \begin{figure}[h!]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/q_group_heat_20.png}
        \caption{Quantity evolution in a competitive market}
        \label{fig:large_local}
    \end{figure}
\end{center}

The lack of collusion can be seen more clearly in the 150 simulations run of price in Figure \ref{fig:price_large_local}.

\begin{center}
    \begin{figure}[h!]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/p_group_20.png}
        \caption{Price evolution in a competitive market}
        \label{fig:price_large_local}
    \end{figure}
\end{center}

\subsection{Global markets}

In order to study the effect of groups on the equilibria of the game we first look at a simple simulation run with, as before, $N = 5$ and $M = 4$ (Figure \ref{fig:small_avg}). In the figure, two lines (average quantity per group), get colored the same 

\begin{figure}[h!]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/group/q_group_4-5.png}
    \caption{Average quantities with $4$ markets of size $5$}
    \label{fig:small_avg}
\end{figure}

The same dynamics can be seen by plotting the profits over this run (Figure \ref{fig:small_avg_profit}).

\begin{figure}[h!]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/group/pi_group_4-5.png}
    \caption{Profits with $4$ markets of size $5$}
    \label{fig:small_avg_profit}
\end{figure}


Now that we got the intuition for a single run we can do multiple runs for various combinations of $N$ and $M$ to determine the effectiveness of group structure in hindering tacit collusion. Figure \ref{fig:frontier} illustrates this procedure. For each $N \in \set{3, \ldots, 50}$ and $M \in \set{3, \ldots, 20}$, I compute $200$ simulations of the model. I then look at the variance of the long run quantity

\begin{figure}[h!]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/global/small_convergence_low.png}
    \caption{Collusion frontier of $N \in \set{3, \ldots, 50}$ and $M \in \set{3, \ldots, 20}$ }
    \label{fig:frontier}
\end{figure}


\newpage
% Bibliography
\nocite{*}
\pagenumbering{gobble} % stop page numbering
\printbibliography

\end{document}