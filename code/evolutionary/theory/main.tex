\documentclass[american]{scrartcl}
    \usepackage{babel}
    \usepackage[utf8]{inputenc} 
    \usepackage{csquotes}
    \usepackage{amsmath}
    \usepackage{amssymb}
    \usepackage{graphicx} 
    \usepackage{subfigure}
    \usepackage{mathtools}
    \usepackage{float}

    
    \setlength{\parindent}{0em}
    \setlength{\parskip}{0.5em}

    % Bibliography and citations
    \usepackage[bibencoding=utf8, style=apa]{biblatex}
    \bibliography{ref}

    
    \title{A model of Cournot Competition with group selection}


    \author{Andrea Titton}
    

% Commands
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\Two}{\mathbf{2}}
\newcommand{\E}{\mathbb{E}}

\begin{document}

% Title

\maketitle

\section{Introduction}

In 1838, Antoine Augustin Cournot introduced his famous model of competition over quantities. Since then, the model served as a theoretical benchmark for pure oligopolistic models in economic theory. In Cournot oligopolies, a discrete number of firms compete by setting quantities of a perfectly substitutable good. In equilibrium, due to symmetry, all firms produce the same quantity and any deviations my producers reduces their own profit.

In proposing the model, Cournot does not address the formation mechanisms of the firms' strategies. Modern economics relies on rational expectations to justify the symmetric equilibrium solution. More contemporary approaches have derived the model dynamics under limited knowledge (\cite{Bischi2015}) or naive expectations (\cite{Cnovas2008}). Furthermore the model is known to lead to unstable equilibria as the number of firms increases (Cournot–Theocharis problem).

In this short paper I propose to study the dynamics of equilibrium formation via an evolutionary lens. The aim is to focus on the tacit collusion effect that leads to oligopolistic equilibria in concentrated markets and the competition effect that arises in fragmented markets. I develop a model with local markets competing à la Cournot. Firms evolve in a birth-death process, which can be thought of as firms being able to adapt production technology based on the best performing firm within their market after a certain amount of periods. Here the standard results applies, that is, tacit collusion being stable with only few firms. The model is then extended to encompass group effects, based on the framework by \citeauthor{Akdeniz2020} (\citeyear{Akdeniz2020}). In particular, I show how tacit collusion can be sustained for larger oligopolies, as long as competition at a group level (i.e. between local markets) emerges slowly.


\section{Theoretical formulation}

Any variable $x^{(i)}_t$ is indexed such that the superscript refers to the individual and the subscript to time.

\subsection{Local markets}

Local markets are composed by $N$ firms, indexed by $i$, that can pick a production quantity from a discrete set $q^{(i)} \in \Sigma$. Firm's face linear demand,

\begin{equation}
    p(Q) = p\left(q^{(1)}, q^{(2)},  \ldots, q^{(N)} \right) = a - b \cdot \sum^{N}_{i=1} q^{(i)}
\end{equation}

where $Q$ is the vector of quantities and $a$ and $b$ are picked for normalization purposes. Furthermore firm face no fixed nor marginal costs. All of these assumptions can be easily relaxed to allow for non-linear demand, entry costs, and marginal costs. The symmetric Nash equilibrium of the game is,

\begin{equation}
    \bar{q}= \frac{a}{b \cdot (N+1)}
\end{equation}



The model evolves over discrete time $t \in \set{0, 1, \ldots T}$ and firms are assumed to enter the market playing a random draw from the strategy set,  $q^{(i)}_0 \sim U(\Sigma)$. In every period each company realizes a payoff, $\pi^{(i)}_t = p(Q_t) \cdot q^{(i)}_t$. I assume that each period a firm is picked at random, with probability proportional to its payoff, to reproduce in a birth-death process. In particular, the probability of a strategy, say $\sigma \in \Sigma$ played by $n$ firms, being picked for reproduction is,

\begin{equation}
    \frac{n \cdot \exp(P(Q_t) \cdot \sigma)}{\sum_{i} \exp(P(Q_t) \cdot q^{(i)})}.
\end{equation}



This modelling choice is justified in the context of oligopolies were firms copy other firms' production quantities in case the competitor is experiencing better profits. This arises for example in the airline industry, were capacity (number of flights) has to be planned \textit{ex-ante} to comply with regulations. Furthermore, these are markets with high barriers to entry (fixed $N$), long-term investment commitments (randomness in the birth-death process), and common tacit collusion.

\subsection{Global market}

In the model, there are $M$ local markets and each local market is linked to two other neighboring markets, thus forming a cycle. With arrival rate $\rho$, a market is picked at random, with probability $1 / N$, and is merged with its best performing neighbor. This choice arises assuming that highly profitable local markets will be invaded by neighboring firms. In this way tacit collusion, on the one hand, pushes up payoffs and, on the other hand, it increases the likelihood of a neighboring entry.



\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/step_group.png}
        \caption{Diagram illustrating the takeover in the global market}
        \label{fig:diagram}
    \end{figure}
\end{center}


\section{Simulation}

In the simulations I pick $\Sigma = \set{1, 2, \ldots, 10}$, $a = (N + 1) \cdot 5$, and $b = 1$, such that,

\begin{equation}
    \bar{q} = 5
\end{equation}

\subsection{Local market}

First we can focus on a simulation of a local market, without group effects. In particular here we look at the evolution of quantities and prices, first with a concentrated market ($N = 5$) and then with a competitive market ($N = 20$).

Figure \ref{fig:small_local} shows a quantity heat map for one of the runs, with $T = 200$, in the case of a concentrated market. Each row represents a firm in the market and each column a time step. Darker colors are associated with smaller quantities. As expected, tacit collusion occurs vary quickly as all firms synchronize to a low quantity.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/q_group_heat_5.png}
        \caption{Quantity evolution in a concentrated market}
        \label{fig:small_local}
    \end{figure}
\end{center}

Figure \ref{fig:price_small_local} displays the price evolution $p(Q_t)$ of $150$ simulations with concentrated markets. All simulations display tacit collusion but also high path dependency of the equilibrium price. This is expected as, for example, if enough firms start off producing a quantity above $\bar{q}$ which yields $p(Q_0) \approx 0$, firms who produce the highest quantity have higher fitness and hence the price will be driven further down.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/p_group_5.png}
        \caption{Price evolution in a concentrated market}
        \label{fig:price_small_local}
    \end{figure}
\end{center}

If we turn our attention to a highly competitive markets and we repeat the exercise, the dynamics change drastically. In particular, Figure \ref{fig:large_local} shows the evolution of strategies of a single run. Here firms fail to collude and prices tend towards the equilibrium.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/q_group_heat_20.png}
        \caption{Quantity evolution in a competitive market}
        \label{fig:large_local}
    \end{figure}
\end{center}

The lack of collusion can be seen more clearly in the 150 simulations run of price in Figure \ref{fig:price_large_local}.

\begin{center}
    \begin{figure}[H]
        \center
        \includegraphics[width=0.8\textwidth]{../plots/local/p_group_20.png}
        \caption{Price evolution in a competitive market}
        \label{fig:price_large_local}
    \end{figure}
\end{center}

\subsection{Global markets}

In order to study the effect of groups on the equilibria of the game we first look at a simple simulation run with, as before, $N = 5$ and $M = 4$. In Figure \ref{fig:small_avg}, two lines, representing the average quantity in each group, are plotted with the same color if in that period the local markets are merged. Already from a simple run we can see how tacit collusion can be sustained in larger groups, if these arise from smaller prior groups which were in a tacit collusive equilibrium. In fact in our simulation $N = 20$ does not sustain collusion but $M = 4$ and $N = 5$ does (note that $M\cdot N = 20$ is the long run size of the group).

\begin{figure}[H]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/group/q_group_4-5.png}
    \caption{Average quantities with $4$ markets of size $5$}
    \label{fig:small_avg}
\end{figure}

The same dynamics can be seen by plotting the profits over this run (Figure \ref{fig:small_avg_profit}).

\begin{figure}[H]
    \center
    \includegraphics[width=0.8\textwidth]{../plots/group/pi_group_4-5.png}
    \caption{Profits with $4$ markets of size $5$}
    \label{fig:small_avg_profit}
\end{figure}

A natural step is now to see how the frequency of takeovers, $\rho$, affects the sustainability of tacit collusion. This influences the expected size of the local markets as follows,

\begin{equation}
    \E[N_t] = N \cdot \min\left\{M, (1 + \rho)^t \right\}
\end{equation}

To study this, given $M = 40$, for each $N \in \set{3, 4, \ldots, 40}$ and $\rho \in \set{0, \frac{1}{100},\frac{2}{100}, \ldots, 1}$, I compute $200$ simulations of length $T = 200$ of the model. I then look at the variance of the quantity in each group at the end of the 200 periods. If the variance is 0 we have evidence of tacit collusion since each firm is playing the same quantity. Finally, I compute the average variance across groups and simulations. The result of this exercise is presented in Figure \ref{fig:frontier} where $N$ is plotted on the $x$-axis, $\rho$ on the $y$-axis, and the intensity of the color is the mean quantity variance. Hence dark colors represent common tacit collusion. The simulation clearly shows that low frequencies of mergers renders tacit collusion sustainable with larger groups.

\begin{figure}[H]
    \center
    \includegraphics[width=0.95\textwidth]{../plots/global/small_convergence_restr.png}
    \caption{Collusion frontier of $N \in \set{3, 4, \ldots, 40}$ and $\rho \in [0, 1]$ }
    \label{fig:frontier}
\end{figure}

\section{Conclusions}

In this short paper I present a tentative analysis of the dynamics of an oligopolistic market with Cournot competition and group structure. In particular I show how, ceteris paribus, tacit collusion can be sustained for larger market sizes in the presence of slowly merging local markets. The analysis is by no means exhaustive. In particular it lacks an analytical derivation of the relationship between $M$ and $\rho$, and the instability of tacit collusion. Nevertheless, I believe that introducing group structure and evolutionary dynamics can help greatly in modelling the dynamical aspects of Cournot games.

\newpage
% Bibliography
\nocite{*}
\pagenumbering{gobble} % stop page numbering
\printbibliography

\newpage
\appendix

\section{Expected size of global markets} \label{A:exp_size}



\end{document}